

<!DOCTYPE HTML>
{% macro static_url(name) -%}
   {{ base_project_url }}static/{{ name }}
{%- endmacro %}
<html lang="en">

<head>
    <meta charset="utf-8">

    <title>{% block title %}User Testing Narrative{% endblock %}</title>
    <link rel="shortcut icon" type="image/x-icon" href="{{static_url("kbase/images/KBase_favicon.ico") }}">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link rel="stylesheet" href="{{static_url("components/jquery-ui/themes/smoothness/jquery-ui.min.css") }}" type="text/css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    {% block stylesheet %}
    {% block lesscss %}
	    {% if use_less %}
	        <link rel="stylesheet/less" href="{{ static_url("style/style.less") }}" type="text/css" />
	    {% else %}
	        <link rel="stylesheet" href="{{ static_url("style/style.min.css") }}" type="text/css"/>
	    {% endif %}
    {% endblock %}
    {% endblock %}
    <link rel="stylesheet" href="{{ static_url("custom/custom.css") }}" type="text/css" />
    <link rel="stylesheet" href="{{ static_url("kbase/css/kbaseStylesheet.css") }}" type="text/css" />
    <link rel="stylesheet" href="{{ static_url("kbase/css/narrative.css") }}" type="text/css" />
    <!--<link href="//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet">-->
    <link rel="stylesheet" href="{{ static_url("kbvis/ext/font-awesome/3.2.1/css/font-awesome.css") }}" type="text/css" />
    <link rel="stylesheet" href="{{ static_url("kbvis/ext/font-awesome/4.0.3/css/font-awesome.css") }}" type="text/css" />
    <link rel="stylesheet" href="{{ static_url("kbase/css/kbaseNarrFunc.css") }}" type="text/css" />
    <link rel="stylesheet" type="text/css" href="{{ static_url("kbase/css/landing-pages.css") }}" />

    <script src="{{ static_url("components/bowser.min.js") }}" type="text/javascript" charset="utf-8"></script>
    <script>
      /**
       * A snippet of code to check the browser's version and alert the user if they're using IE <= 9.0.
       * This puts a flag in sessionStorage - as long as that flag's there, the check won't be done again
       * (to avoid having the same thing happen on page refreshes and such).
       *
       * This uses Bowser to detect the browser and version:
       * https://github.com/ded/bowser
       */
      function checkBrowser() {
        var browserCheckItem = 'kbBrowserCheck';

        //Just return if we've done this already this session. Seeing the same popup more than once is obnoxious.
        if (sessionStorage) {
            if (sessionStorage.getItem(browserCheckItem))
                return;
        }

        var alertPrefix = 'Unsupported browser detected!\n\n';
        var alertSuggest = 'For a better experience, we recommend using recent versions of ' + 
                           'Safari, Firefox, Chrome, or Internet Explorer.\n\n' +
                           'Sorry for any inconvenience!';
        var alertError = '';
        if (bowser.msie && bowser.version <= 9) {
            var alertError = 'You appear to be using Internet Explorer ' + 
                             bowser.version + 
                             '. Unfortunately, we don\'t support that web browser. Many ' +
                             'functions will be unavailable or have compatibility problems.\n\n';
        }

        if (alertError) {
            alert(alertPrefix + alertError + alertSuggest);
        }

        if (sessionStorage) {
            sessionStorage.setItem(browserCheckItem, '1');
        }
      }

      checkBrowser();
    </script>



<!--    <script src="{{static_url("components/requirejs/require.js") }}" type="text/javascript" charset="utf-8"></script> -->
    <script src="{{ static_url("kbase/js/ui-common/ext/requirejs/2.1.9/require.js") }}" ></script>

    <script>
      require.config({
          baseUrl: '{{ static_url() }}',
      });

      var kb_use_require = true;
      var kb_norequire = function(deps, callback) {
          callback(jQuery);
      };
      var kb_nodefine = function(module, deps, callback) {
          callback(jQuery);
      };
      if (kb_use_require) {
          kb_define = define;
          kb_require = require;
      }
      else {
          kb_define = kb_nodefine;
          kb_require = kb_norequire;
      }

      kb_require(['narrative_paths'], function() {
          kb_require(['jquery', 'CDMI_API'],
              function($) {
                  //add initialization code
                  console.log('made it so?');
              }
          );
      });
    </script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      
      ga('create', 'UA-48256002-1', 'kbase.us');
      ga('send', 'pageview');
      
    </script>
    {% block meta %}
    {% endblock %}

</head>

<body {% block params %}{% endblock %}>

<noscript>
  <div id='noscript'>
    The KBase Narrative requires JavaScript.<br>
    Please enable it to proceed.
  </div>
</noscript>


<div class="nav navbar-kbase navbar-fixed-top nav-collapse nav-collapse-scrollable bs-navbar-scroll-collapse">
    <a href="http://www.kbase.us" class="pull-left">
        <img id="logo" src="static/kbase/images/kbase_logo.png" width="46">
    </a>

    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
        <li class="dropdown active">
          <a href="/functional-site/#" class="dropdown-toggle" data-toggle="dropdown">Narrative <b class="caret"></b></a>
          <ul class="dropdown-menu">
            <li><a href="/functional-site/#/narrative/">Newsfeed</a></li>
            <li><a href="/functional-site/#/narrative/projects/">Projects</a></li>
          </ul>
        </li>
        <li><a href="/functional-site/#/search/?q=*">Search Data</a></li>
        <li><a href="/functional-site/#/ws/" id="workspace-link">Workspaces</a></li>
        <li><a href="http://kbase.us/services/docs/uploader/uploader.html">Upload</a></li>
      </ul>

      <div id="signin-button" class="pull-right"></div>
      <ul class="nav navbar-nav pull-right">
          <li class="dropdown help-dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Help <b class="caret"></b></a>
                 <ul class="dropdown-menu">
                 <li><a href="http://kbase.us/for-users/narrative-quick-start/" target="_new">Narrative Quick Start Guide</a></li>
                 <li><a href="mailto:help@kbase.us">Email help@kbase.us</a></li>
              </ul></li>
      </ul>
    </div>
</div>

    {% block login_widget %}

    <div id="login-info" class="pull-right">
      <div id="login-widget">
      </div>
      <!--         <span></span>
           <a href="#" onclick="logout();">log out</a>
      -->    </div>

      <div id="login_widget">
        {% if logged_in %}
        <button id="logout">Logout</button>
        {% elif login_available and not logged_in %}
        <button id="login">Login</button>
        {% endif %}
      </div>

      {% endblock %}

<div id="site">
{% block site %}
{% endblock %}
</div>

        <div id="app" class="wrapper" ui-view></div>

        </div> <!-- end wrap, this pushes the footer down -->
            <div id="footer">
              <div class="disclaimer">This site is for demonstration purposes only.</div>
            </div>

<script src="{{ static_url("components/jquery/jquery.min.js") }}" type="text/javascript" charset="utf-8"></script>
<script src="{{ static_url("components/jquery-ui/ui/minified/jquery-ui.min.js") }}" type="text/javascript" charset="utf-8"></script>

<script>
  var configJSON = $.parseJSON(
                      $.ajax({ 
                               url: "{{ static_url('kbase/config.json') }}", 
                               async: false, 
                               dataType: 'json'
                             }).responseText );
  window.kb = { urls : configJSON[configJSON['config']] };
</script>

<script src="{{ static_url("components/bootstrap-3/js/bootstrap.min.js") }}" type="text/javascript" charset="utf-8"></script>
<script src="{{ static_url("base/js/namespace.js") }}" type="text/javascript" charset="utf-8"></script>
<script src="{{ static_url("base/js/page.js") }}" type="text/javascript" charset="utf-8"></script>

<!-- KBase Narrative Extensions -->
<script src="{{ static_url("kbase/js/jquery.cookie.min.js") }}" type="text/javascript" charset="utf-8"></script>
<script src="{{ static_url("kbase/js/widgets/kbwidget.js") }}" type="text/javascript" charset="utf-8"></script>
<script src="{{ static_url("kbase/js/widgets/kbasePromptNew.js") }}" type="text/javascript" charset="utf-8"></script>
<script src="{{ static_url("kbase/js/widgets/kbaseLoginFuncSite.js") }}" type="text/javascript" charset="utf-8"></script>
<script src="{{ static_url("kbase/js/widgets/narrativeLogin.js") }}" type="text/javascript" charset="utf-8"></script>
<script src="{{ static_url("kbase/js/header.js") }}" type="text/javascript" charset="utf-8"></script>
<!-- End KBase Extensions -->

<script src="{{ static_url("auth/js/loginwidget.js") }}" type="text/javascript" charset="utf-8"></script>

{% block script %}
    {% if use_less %}
        <script src="{{ static_url("components/less.js/dist/less-1.3.3.min.js") }}" charset="utf-8"></script>
    {% endif %}
{% endblock %}

<script src="{{static_url("custom/custom.js") }}" type="text/javascript" charset="utf-8"></script>

</body>

</html>
